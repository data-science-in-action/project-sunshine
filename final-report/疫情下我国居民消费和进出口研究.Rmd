---
title: "疫情下我国居民消费和进出口研究"
author: "梁青庆　　双美俊　　刘利姣　　冯晓方"
fontsize: 12
output:
  html_document:
    df_print: paged
  pdf_document:
    latex_engine: xelatex
geometry:
- top=2.5cm
- bottom=2.5cm
- lmargin=2.5cm
- rmargin=2.5cm
CJKmainfont: Microsoft YaHei
---

# 摘要

　　2020年初，一场突如其来的新冠肺炎疫情迅速蔓延至全国。受疫情影响，人口流动受限，大范围企业延迟复工复产，疫情对中国经济形势的影响越来越引起人们关注。本文重点从总需求、总供给、通货膨胀等维度分析了疫情对经济增长的影响，首先分别利用季节乘积模型和灰色马尔可夫模型对我国2020年1-4月社会消费品零售总额、进出口总额进行预测，接着应用聚类分析研究2020年2月不同地区各类居民消费价格指数。经分析，我国的社会消费品零售总额和进出口总额损失率逐渐下降，所有地区的食品烟酒类价格指数有所上升，交通运输价格指数最低。可见，短期来看，新冠肺炎疫情对宏观经济的影响，会不可避免地造成短期消费和对外贸易的萎缩，但长期来看，疫情对宏观经济的冲击只是暂时性，中国经济基本面仍然以平稳向好为主。

**关键词：**  消费;进出口;新冠肺炎;乘积季节模型;灰色马尔可夫模型

# 1 引言

## 1.1 研究背景

　　自2020年初，中国武汉地区爆发新型冠状病毒肺炎疫情，并且在短期内迅速传播，发展成为全国性的传染疫情。新冠肺炎疫情爆发以来,在党中央国务院的坚强领导下,全国上下实施的超强抗击疫情措施取得了显著成效,然而大范围企业停工与全国范围超常强制性隔离措施也带来了巨大经济代价。新冠肺炎疫情将从多个维度对经济增长产生负面冲击，如总需求、总供给、通货膨胀等。
　　
　　　　由于发生时间点处于春节假期，疫情直接影响了我国各个行业的正常经营，尤其是餐饮、交通、旅游等行业，抑制社会消费，阻碍了商品的正常流通，不可避免地导致社会消费品零售总额显著下滑。其次,疫情对进出口也造成明显冲击。对比来看,美国、意大利等国疫情严重程度已远超我国,为有效控制疫情,多国均采取“封航”“封国”“封城”等措施,使得全球贸易活动锐减甚至停滞,对全球产业链的正常运转造成重创。此外，疫情爆发对供给产生的负面冲击、生活必需商品和服务的需求刚性，叠加因供给原因生猪价格在上半年可能持续上涨的影响，预计居民消费价格指数将面临较大的上涨压力。

　　居民消费可以直接反映人民生活状况，疫情的全球化蔓延也影响着我国对外贸易，研究疫情对我国经济的影响具有重要意义。为探究此次疫情的影响程度，本文对宏观经济指标分析，测算此次疫情对我国消费及进出口影响大小。
    
## 1.2 文献综述

　　目前关于新冠肺炎疫情影响的研究主要聚焦在两个方面:一是基于宏观视角分析疫情对我国产生的影响，比如经济增长、外贸、就业、生活和消费等方面；二是从中观层面剖析疫情冲击下产业发展面临的困境，如旅游业、交通运输业和农业等产业。本文主要参考了以下文献：
    
　　郑江淮等通过对“非典”前后的宏观经济和消费形势复盘，比较了新冠肺炎疫情与“非典”疫情，分析新冠肺炎疫情对消费经济造成的潜在影响。韩玉锦等从社会消费品零售总额这一指标分析,采用灰色预测模型测算此次疫情对该指标的影响大小。刘夏等分别采用ARIMA模型和灰色马尔科夫模型对2012-01—2017-12月三亚的交通流量进行拟合仿真,并对2018年每月的客流进行了趋势外推预测。肖学培等通过建立季节性ARIMA模型来预测2019年各月的社会消费品零售总额情况。何海阔等应用灰色模型和乘积季节模型预测承德市布鲁菌病的发病趋势, 发现乘积季节模型对布鲁菌病的预测效果更好。黄薇证明了用灰色马尔可夫模型预测进出口总额的预测精确度高于灰色预测模型,具有较高的实际应用价值。马永梅和林天水以2016年我国31个省市自治区的CPI价格指数为研究对象,利用谱系图确定聚类的个数, 并构建评价函数改进初始聚类中心,聚类结果显示把31个地区分为四类比较合适, 最后结合我国当前的发展形势对不同类别地区提出相应的价格控制建议。

　　上述学者们主要通过时间序列模型和灰色模型等对宏观经济指标进行了预测分析比较，这为本文的研究提供了坚实的基础。不同的研究选择了不同的经济指标，会使得研究结论有所不同；其次，随着时代变迁和客观条件的改变，2020年突发的新冠疫情使得研究的背景与以往也不相同。因此，本文利用我国消费、进出口总额等相关数据，并结合实际情况进行分析，探究疫情对我国经济的影响。

## 1.3 研究思路与方法

　　1.预测分析。本文采用2008年到2019年我国社会消费品零售总额和进出口总额月度数据，分别建立乘积季节模型和灰色马尔可夫模型，对2020年1-4月份进行预测，并与实际数值进行对比分析，量化分析疫情带来的经济影响。

　　2.聚类分析。本文首先采用2020年2月我国31个省市自治区直辖市的八大类商品居民消费价格指数为研究对象进行聚类分析；其次，将聚类结果同各地区的疫情情况进行综合分析并提出建议。

　　本文综合应用灰色马尔可夫预测模型、季节ARIMA模型和聚类分析等方法，对我国消费、进出口、居民消费价格指数等相关数据进行分析，并预测新冠肺炎疫情对消费、对外贸易、物价的影响及对策分析。

# 2 理论基础

## 2.1 时间序列的的相关理论

### 2.1.1 时间序列概述

　　时间序列主要是通过观察某一现象随着时间的变化所呈现出来的变动，是动态过程。它不仅能够展示出现象随时间发展变化的动态趋势，还可以预测该现象的发展方向和未来前景。随机时间序列分析模型分为三种类型：自回归模型(AR)、移动平均模型(MA)和自回归移动平均模型(ARMA)。而ARMA模型研究的只是平稳时间序列，那么对于非平稳时间序列则常采用自回归综合移动平均模型ARIMA。ARIMA模型又可分为带趋势性的ARIMA模型，和既带有趋势又有季节性趋势的SARIMA模型。

### 2.1.2 季节ARIMA模型介绍

　　有些非平稳序列不仅带有趋势，而且经常依时间而呈现的周期性变化，通常称一个序列呈现以s(s为一正整数)为周期的季节ARIMA模型。一般季节ARIMA模型的表达式为：
　　$$\phi_{p} (L)\Phi _{p}(L^{s})\bigtriangledown ^{D}\bigtriangledown ^{d}x_{t}=\theta_{q} (L)\Phi _{Q}(L^{s})\mu_{t}$$
　　其中，P,Q，p,q分别表示季节与非季节自回归、移动平均算子的最大滞后阶数，D,d分别表示季节与非季节性差分次数。


### 2.1.3 建模流程

　　(1)序列平稳性检验：为了模型可以顺利建立，必须要对其平稳性进行检验。对序列的平稳性有两种检验方法，一种是根据时序图和自相关图与偏自相关图显示的特征做出判断的图检验方法；另一种单位根检验方。对非平稳的时间序列，我们可以先对序列进行对数或差分处理。


　　(2)模型识别：模型识别的方法有两种：一为根据ACF与PACF图判断；二为根据AIC、BIC准则判断阶数，选择AIC、BIC的最小值。

　　(3)参数估计：确定模型阶数后，应对模型进行参数估计。本文采用最小二乘法OLS进行参数估计，确定出模型的参数。

　　(4)模型检验：完成模型的识别与参数估计后，应对估计结果进行诊断与检验，以求发现所选用的模型是否能够用于预测。一是检验模型参数的估计值是否具有显著性; 二是检验模型的残差序列是否为白噪声。

　　(5)模型预测：根据建模分析结果，得到最优模型，据此进行预测研究，判断原始序列的未来走向和发展。


## 2.2灰色马尔科夫的相关理论

### 2.2.1灰色马尔科夫概述

　　灰色系统预测主要用于时间短、数据资料少、波动不大的预测问题。马尔可夫链反映了各种随机因素的影响程度,适合于随机波动性较大的预测问题，但要求时间序列具有平稳过程的特点,然而预测对象常常是随时间变化而呈现某种变化趋势的非平稳随机过程，这样正好采用灰色GM(1,1)模型对时间序列进行拟合，找出其变化趋势。

### 2.2.2灰色马尔科夫建模流程

　　(1)预测状态的划分：根据灰色模型得到的拟合值和真实值计算残差相对值，依据残差相对值进行状态的划分，确定原始序列所处的状态。

　　(2)状态转移概率矩阵的创建：计算转移频数矩阵和一步转移概率矩阵，并对序列进行马氏性检验。如果序列没有通过马氏性检验，则不能建立马尔科夫模型；反之，则计算n步转移概率矩阵来确定下一时刻所处状态。

　　(3)预测值的计算：利用下式修正灰色模型的拟合预测值。
　　$$\tilde{X}^{(0)}(k)=\frac{1}{2}\times(\frac{\hat{X}^{(0)}(k)}{1-\varepsilon_{1}(k)}+\frac{\hat{X}^{(0)}(k)}{1-\varepsilon _{2}(k)})$$


## 2.3 K均值聚类的相关理论

### 2.3.1 K-mean算法概述

　　K-means算法的基本思想为对于给定的样本集，按照样本之间的距离大小，将样本集划分为K个簇。让簇内的点尽量紧密的连在一起，而让簇间的距离尽量的大，两个对象之间的距离越近，相似性越高。聚类的结果就是使类内部的同质性高，而类之间的异质性高。

### 2.3.2 K-mean算法步骤

　　(1)输入聚类数目K和待分类数据集：在K-Means聚类中，要根据最终的聚类效果，实际选取K值。

　　(2)确定K个初始类质心：常见的初始类质心的指定方法有：经验选择法、随机选取法、最小最大法。

　　(3)判断数据所属分类：根据欧几里得距离来判断相似度量，判断每个对象数据属于哪个类。

　　(4)重新确定K个类质心：重新计算K个类的质心（类中各观测点均值），并以该均值点作为新的类质心。

　　(5)计算准则函数：聚类准则函数E用于判断聚类质量的高低,误差平方和准则函数E的值在算法的每次迭代过程中逐渐减小,最终收敛至一个固定的值,这时算法迭代结束。聚类准则函数E的值越小，聚类的质量越高。

　　(6)循环三、四、五步直到准则函数E在允许的误差范围内


# 3 描述性统计

## 3.1 疫情描述性统计

```{r, fig.width = 10, fig.height = 2,fig.align='center',  fig.cap=" COVID-19疫情图", echo=FALSE, warning=FALSE,message=FALSE}
library(ggplot2)
library(reshape2)
 data<-read.csv("data/COVID-19.csv")
 data<-melt(data,id.vars = 'day', variable.name = "type",value.name = "num")
ggplot(data = data, mapping = aes(x = day, y = num, colour = type , group = type))+geom_line(size = 0.5) + geom_point(size = 1.5)+
  theme(axis.text.x = element_text(angle = 60, hjust = 0.5, vjust =0.5 ,size = 8))
```

　　从图1可以看出，累计确诊人数从2月份开始迅速增加，但是从3月份开始曲线变得平稳，每日间的差异并不明显。累计死亡人数曲线总体来看较为平稳，每日间的差异并不大。累计治愈人数从2月份开始增加，同样3月份开始增速相对下降。这充分说明我国疫情在3月底基本得到了有效控制。

## 3.2 社会消费品零售总额描述性统计

　　由图2可得，随着时间的推移社会消费品零售总额整体显示出逐年上升的趋势。这是因为我国经济水平日益提升，人民消费水平也随之提高。　　
```{r, fig.width = 5, fig.height = 1.5,fig.align='center',fig.cap="社会消费品零售总额图",echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
data<-read.csv("data/trscg.csv")
data1<-data
data1$time<-factor(data1$time)
p=ggplot(data1, aes(x=time, y=TRSCG, group=1)) + geom_line()+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
print(p)
```

## 3.3 进口、出口描述性统计

```{r, fig.width = 5, fig.height = 2, fig.align='center',fig.cap=" 进口出口图", echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(reshape2)
data<-read.csv("data/output and input.csv")
data<-melt(data,id.vars = 'month', variable.name = "type",value.name = "num")
ggplot(data=data, aes(x=month, y=num, group=type,color=type))+
  geom_line(size = 0.5) + geom_point(size = 1.5)+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
```
　　
　根据图3可得，进口、出口序列均呈现出逐年上升的趋势，且存在着季节性。2020年3月份的进口、出口额较2019年有所减少。这是由于受到新冠疫情的影响，为控制疫情，多国采取了“封航”、“封国”、“封城”的措施，全球贸易活动锐减，对我国的进出口行业造成了巨大影响。

# 4 疫情下居民消费和进出口影响分析

　　本章节包括社会消费品零售总额和进出口总额的预测分析和居民消费价格水平的聚类分析。通过对居民消费和进出口的影响测算，分析新冠疫情对我国经济的影响。
    
## 4.1 社会消费品零售总额预测分析
  
　　通过对2008-2019年社会消费品零售总额月度数据建立SARIMA模型，预测2020年1-4月份月度数据。
    
### 4.1.1 平稳性检验
```{r, include=FALSE,fig.width = 4,fig.height=2.5,fig.align='center',fig.cap=" 原始数据时序图", echo=FALSE, warning=FALSE, message=FALSE}
library(tseries)
library(forecast)
library(zoo)
library(stats)

y=read.csv('data/trscg.csv',header = T)
TRSCG=ts(y$TRSCG, frequency=12, start=c(2008, 1))
plot.ts(TRSCG, col=4, xlab="time", ylab="TRSCG")

```
　　首先查看原始序列时序图，具有周期性和长期增长的趋势，为非平稳时间序列。在此基础上，对原始数据进行一阶差分，差分后的时序图没有明显的线性趋势，且差分后p值为0.01小于0.05说明序列已平稳，但仍能看到周期为12的周期性，所以加入季节性因子，考虑12阶差分。12阶差分后，序列中季节性影响已被剔除，序列平稳。

### 4.1.2 模型定阶

　　绘制差分后的自相关与偏相关图。ACF与PACF图大致呈正弦衰减趋于零，表现为拖尾。确定模型ARIMA(p,d,q)。对于非季节性，自相关图在滞后1阶缩小为0，确定q=1；偏相关图滞后1阶和2阶超出了虚线位置，且在2阶后截断，因此确定p=2。对于季节性，查看lag12、24处是否超出虚线位置，从PACF看出P=0，从ACF看出Q=0，选取模型为：ARIMA(2,1,1)(0,1,0)[12]。
　　
```{r,fig.width = 8, fig.height = 2.5, fig.align='center', fig.cap=" ACF和PACF图", echo=FALSE, warning=FALSE, message=FALSE}
diff1<-diff(TRSCG)
diff2=diff(diff1,12)
par(mfrow = c(1, 2))
acf(diff2)
pacf(diff2)

```  

### 4.1.3 模型建立与预测

　　(1) 模型的参数估计:利用最小二乘的方法对模型的参数进行了估计，各变量的系数如下表所示：
 
|参数  | ar1 | ar2 | ma1 |
|:-:|:-:|:-:|:-:|
| coefficients | -0.25 | -0.22 | -0.05 |
| s.e | 0.35 | 0.12 | 0.35|

　　(2) 模型的适应性检验:残差的正态性检验通过;LB统计量的p值为0.9603>0.05，白噪声检验通过。

　　ACF与PACF图大致呈正弦衰减趋于零，表现为拖尾。确定模型ARIMA(p,d,q)。参数估计后，对模型做适应性检验。判断残差是否是平均值为零且方差为常数的正态分布且检验残差序列是否为白噪声序列。通过分析得到残差的正态性检验通过。残差的白噪声检验，LB统计量的p值为0.9603>0.05，拒绝原假设，认为残差是独立的。因此模型的两个检验均通过，模型拟合效果不错。    

　　(3) 利用SARIMA模型进行预测

| 时间 | 预测值 | 置信区间 | 
|:-:|:-:|:-:|
| 2020.01 | 34022.76 |	(25261.69, 42783.83) | 
| 2020.02 | 34039.79 |	(25278.91, 42800.68) | 
| 2020.03 | 32900.22 |	(24139.39, 41661.05) |
| 2020.04 | 35270.23 |	(26509.40, 44031.06) |

### 4.1.4 结果对比分析
    
```{r,fig.width = 3, fig.height = 2, fig.align='center', fig.cap=" 社会消费品零售总额对比图", echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
df <- data.frame(type = rep(c("real", "predictive"), each=3),
                  time=c("2020.1-2", "2020.3", "2020.4"),
                  trscg=c(52129.8, 26450, 28177.8, 68062.55, 32900.22, 35270.23) )
ggplot(data=df, mapping=aes(x=time, y=trscg, group=type)) +
  geom_line(aes(color=type))+
  geom_point(aes(color=type))+
  theme(legend.position="top")

```  

　　残差的正态性检验通过;LB统计量的p值为0.9603>0.05，白噪声检验通过。通过将社会消费品零售总额2020年1-4月的真实值和预测值进行对比，得到损失率分别为23%，20%，20%。其中1-2月份社会消费品零售总额经济损失比较大，主要是由于疫情发生以来，按照疫情防控需要，居民主动减少外出购物，取消了聚餐聚会等，居民消费受到抑制，消费市场受冲击明显。3月开始疫情得到了基本控制，陆续开始复工复产，所以3月，4月的损失率有所缓解。
    





## 4.2 进口总额预测分析
  
　　对2008-2019年进口总额年均值建立灰色马尔科夫模型，对2020年进口总额年均值进行预测，然后根据历年数据各月进口额所占比例，测算2020年1-4月各月进口额，并与真实值进行比较分析。
    
### 4.2.1 GM(1,1)模型

　　建立灰色模型前，首先对原始数据进行级比检验和光滑度检验。通过对原始数据进行级比检验和光滑度检验，没有通过，在此基础上对原始数据进行开方处理，检验通过。根据灰色系统理论，对2008-2019年进口总额开方数据建立灰色GM(1,1),模型:
  
| GM(1,1)模型结果 | 
|:-:|
|GM(1,1)参数估计值: 发展系数-a= 0.02 , 灰色作用量u= 33.71  | 
|残差检验：平均相对误差= 5.40 % &emsp;模型精度= 94.60 %  |
|后验差比值检验: C值= 0.29&emsp;C值<0.35, P>0.95, GM(1,1)预测精度等级为：优  |

### 4.2.2 灰色马尔科夫模型

　　(1)残差相对值序列的状态划分为：(-12.7%,-3.5%],(-3.5%,2.5%],(2.5%,8%]
　　

　　(2)一步转移概率矩阵：

$$P=(p_{ij})_{3\times 3}=\begin{pmatrix}
0.33 &0.67  &0 \\ 
0.33 &0  &0.67 \\ 
0.2 &0.2&0.6 
\end{pmatrix}$$
　　
　　马氏性检验:$\chi^{2}=17.98>\chi_{0.05}^{2}\left(4\right)=9.49$,满足马氏性。
　　

　　(3)修正灰色模型的拟合预测值,模型精度为96.35%。与灰色GM(1,1)模型相比，模型精度提高了6.33%。
　　

　　(4)由一步转移概率预测2020年进口总额：24365.10亿美元。根据各月比例，预测2020年1-2月、3月和4月进口额。
    
### 4.2.3 结果对比分析
    
```{r, fig.width =3, fig.height =2,fig.align='center', fig.cap=" 进口总额对比图", echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
df <- data.frame(type = rep(c("real", "predictive"), each=3),
                  time=c("2020.1-2", "2020.3", "2020.4"),
                  input=c(2995.44, 1652.13, 1549.01, 3459.83, 2049.53, 2026.96) )
ggplot(data=df, mapping=aes(x=time, y=input, group=type)) +
  geom_line(aes(color=type))+
  geom_point(aes(color=type))+
  theme(legend.position="top")

```  

　　通过将进口总额2020年1-4月的真实值和预测值进行对比，得到损失率分别为13%，19%，24%。我国进口产品主要为制造业原材料、半成品等，疫情发生以来，国内复工推迟、物流受阻，进口总额受到影响。3月以来疫情逐步在海外蔓延，国外企业停工停产，国外进口商品供给减少，国内进口需求虽在逐步恢复，但恢复的速度比较缓慢,3，4月份影响较大。 

## 4.3 出口总额预测分析

　　对2008-2019年出口总额年均值建立灰色马尔科夫模型，对2020年出口总额年均值进行预测，然后根据历年数据各月出口额所占比例，测算2020年1-4月各月出口额，并与真实值进行比较分析。 
     
### 4.3.1 GM(1,1)模型
　　
　通过对原始数据进行级比检验和光滑度检验，没有通过，对原始数据进行开方处理，级比检验和光滑度检验通过。根据灰色系统理论，对2008-2019年出口总额开方数据建立灰色GM(1,1),模型结果如下：
  
| GM(1,1)模型结果 | 
|:-:|
|GM(1,1)参数估计值: 发展系数-a= 0.03 &emsp;灰色作用量u= 35.07  |
|残差检验：平均相对误差= 4.63 % &emsp;模型精度= 95.37 % |
|后验差比值检验: C值= 0.29&emsp;C值<0.35,P>0.95, GM(1,1)预测精度等级为：优 |

### 4.3.2 灰色马尔科夫模型    
　　(1)残差相对值序列的状态划分为：(-15.5%,-8.2%],(-8.2%,0.9%],(0.9%,6.5%]
　　

　　(2)一步转移概率矩阵：

$$P=(p_{ij})_{3\times 3}=\begin{pmatrix}
0 &1  &0 \\ 
0.2 &0.6  &0.2 \\ 
0 &0.2&0.8 
\end{pmatrix}$$
　　
　　马氏性检验:$\chi^{2}=12.87>\chi_{0.05}^{2}\left(4\right )=9.49$,满足马氏性。
　　

　　(3)修正灰色模型的拟合预测值,模型精度为95.22%。与灰色GM(1,1)模型相比，模型精度提高了3.83%。
　　

　　(4)由一步转移概率预测2020年出口总额：26139.94亿美元。根据各月比例，预测2020年1-2月、3月和4月出口额。

### 4.3.3 结果对比分析
    
```{r,fig.width = 3, fig.height = 2, fig.align='center', fig.cap=" 出口总额对比图",echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
df <- data.frame(type = rep(c("real", "predictive"), each=3),
                  time=c("2020.1-2", "2020.3", "2020.4"),
                  output=c(2924.49, 1851.46, 2002.34, 3631.49, 1971.98, 2084.03) )
ggplot(data=df, mapping=aes(x=time, y=output, group=type)) +
  geom_line(aes(color=type))+
  geom_point(aes(color=type))+
  theme(legend.position="top")

```  
　　
　通过将出口总额2020年1-4月的真实值和预测值进行对比，得到损失率分别为19%，6%，4%，出口总额的经济损失逐渐减小。主要由于1-2月为国内疫情爆发时期，出口供需两端受疫情冲击，国内企业停工停产状态抑制了出口商品的生产，同时多国实行限制措施，出口商品需求量降低。进入3月以来，疫情初步得到控制，大力推进复工复产，前期积压出口订单集中出货，出口迎来明显改善，同时疫情在海外加速蔓延，国内医疗物资大量出口。
     

## 4.4 居民消费价格指数的聚类分析
    
　　居民消费价格指数简称为CPI，是反映与居民生活有关的商品及劳务价格统计出来的物价变动指标，它是在特定时段内度量一组代表性消费商品及服务项目的价格水平随时间而变动的相对数。我国居民消费价格指数按照商品类别可以划分为八大类，分别是食品烟酒、衣着、居住、生活用品及服务、交通和通信、教育文化和娱乐、医疗保健、其他用品和服务。本次研究以2020年2月我国内地31个省市自治区直辖市的八大类商品居民消费价格指数（上年同月=100）为研究对象，利用SSE原则确定最佳聚类个数进行聚类分析，得到聚类结果，对各类地区物价水平进行综合分析。

### 4.4.1 K均值聚类流程

　　(1) 确定聚类个数:本次研究中采用的指标是组内平方和（SSE）来确定最佳聚类个数。组内平方和SSE会随着聚类个数的增加逐渐减小，当SSE减小程度不明显时，认为此时的聚类个数为最佳聚类个数，本文中根据SSE原则确定的聚类个数为四类。

　　(2) 欧式距离进行聚类:当K=4时，根据初始确定的类中心，计算各个样本到聚类中心的欧式距离，根据距离将对象分配到距离最近的群中，重新计算各个类的中心。

　　(3) 聚类结果:重复进行步骤2，当类中心不再变化时输出聚类结果。根据K均值聚类，最终将31个地区划分为四类。

### 4.4.2 聚类结果分析
    
　　在初始聚类中，我们选择了八大类居民消费价格总指数为聚类变量进行聚类，通过对聚类结果的分析，我们观察到不同类别在食品烟酒类价格指数和医疗保健类价格指数上有明显的波动与区别，其他类别表现为相似的状态，因此，我们在此基础上剔除了其他价格指数的影响，仅选择食品烟酒价格水平及医疗保健价格水平两个变量再一次进行聚类，并进行后续分析。根据K均值聚类，最终将31个省市划分为四类，这里的聚类结果与八大类价格指数的聚类结果完全相同。聚类结果如下:

| 类  别 | 省 份 | 
| ------ | ------ |
| 第一类 | 天津市，上海市，内蒙古自治区，西藏自治区，甘肃省，青海省，宁夏回族自治区，新疆维吾尔自治区 |
| 第二类 | 江西省，河南省，湖北省，广东省，广西壮族自治区，海南省，重庆市，四川省，贵州省，云南省 |
| 第三类 | 北京市，山西省 |
| 第四类 | 河北省，山东省，陕西省，辽宁省，吉林省，黑龙江省，江苏省，浙江省，安徽省，福建省，湖南省 |


```{r,include=FALSE}

library(jsonlite)
library(rjson)
library(RJSONIO)
library(ggplot2)
library(RColorBrewer)
library(lubridate)
library(plyr)
library(dplyr)
library(sp)
library(rgdal)
library(maptools)
china=readOGR('data/china-province-border-data/bou2_4p.shp')
chinamap<-fortify(china)
x <- china@data
xs<-data.frame(x,id=seq(0:924)-1)
china_mapdata<-join(chinamap, xs, type = "full")
unique(china@data$NAME)
fl=read.csv("data/map.csv",sep=",")
capdate=read.csv("data/province.csv",header=TRUE,sep=",")

totalconfirm=data.frame(NAME=fl$NAME,
      type=cut(fl$type,breaks=c(1,2,3,4,5),
      labels=c("1","2","3","4"),
        order = TRUE,include.lowest = T,right = F))

df_map<-join(china_mapdata,totalconfirm,type="full")
``` 

```{r,fig.width = 4, fig.height = 3, fig.align='center',  fig.cap=" 聚类分布图", echo=FALSE, warning=FALSE, message=FALSE}
p=ggplot(df_map)+
        geom_polygon(aes(x=long,y=lat,group=group,fill=type),
        colour="white")+
    scale_fill_manual(values = brewer.pal(4,"Blues"))
print(p)
```      

    
　　接下来，我们绘制出了各类类中心的变化柱状图：

```{r, fig.width = 3, fig.height = 2,fig.align='center',fig.cap=" 类中心柱状图", echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

kind <- rep(c("Food alcohol and tobacco","Health care"), each = 4)
type <- rep(c('1','2','3','4'),times = 2)
index <- c(109.4,118.92,111.35,115.31,102.2,101.51,111.3,101.67) 
df <- data.frame(kind=kind, type = type, index = index)
ggplot(data = df, mapping = aes(x = kind,y = index,fill = type))+ 
  geom_bar(stat ='identity',position = 'dodge')+
  coord_cartesian(ylim=c(90,120))
```


　　从图中可以看出，第一类地区，包含新疆、西藏等地，主要位于我国西部地区，这类地区食品烟酒类价格指数在这四类中最低，医疗保健类价格指数变化不大。
    
　　第二类地区为河北、江西、湖北等地，这些地区食品烟酒类价格指数在四类中排第二位，价格水平波动较大。

　　第三类地区为山西、北京。这些地区食品烟酒类价格指数，医疗保健价格指数都比较高，其中医疗保健类价格指数较其他地区最高，说明该地区的医疗价格有所上升。
    
　　第四类地区为陕西、湖南以及中南部沿海至东北地区，这些地区食品烟酒类价格指数在四个类别中排在第三位，医疗保健类价格指数变化不明显。
    
　　从指标上看，所有地区的食品烟酒类价格指数都比较大。结合去年价格变化情况，我们认为食品烟酒类价格指数的变动是多重因素共同影响导致的。19年4、5月份以来畜肉类CPI涨幅明显，可以说当前部分原因是因为价格没有完全回落，同时加上春节、疫情等多方面影响共同导致的食品烟酒类价格指数较大。3-5月以来，根据食品烟酒类环比CPI均低于100，食品烟酒类价格水平也在逐渐回落。

# 5 结论及展望

## 5.1 研究结论

**1.社会消费品零售总额**
    
　　从前文的预测分析中可以看到，2020年1-2月份由于疫情影响我国社会消费品零售总额损失率约为23%，疫情期间管制措施的实施深刻影响着人们的消费生活。进入3月份疫情得到了基本控制，全国各地陆续开始复工复产，3月、4月的损失率有所缓解。疫情的基本控制，复工复产的逐步推进，人民生活逐步回归正轨，日常消费不再受到限制，消费活力逐步恢复。当前各地政府纷纷采取发放消费券等形式拉动居民消费，线上“带货”消费模式更拓宽了居民消费渠道，相信在未来一段时间内，疫情对社会消费品零售总额的影响会逐渐变小。

**2.进口总额、出口总额**
    
　　通过预测分析可以看到，2020年1-2月我国进口总额损失率约为13%，3月以来疫情在国内逐步得到控制，国内进口需求有所恢复，3月份进口总额稍有好转。但不容忽视的是，疫情逐步在海外的蔓延，国外企业停工停产，国外进口商品供给减少，我国进口总额仍然受到很大影响，4月份损失率仍然较大。
    
　　2020年1-2月我国出口总额损失率约为19%，疫情期间停工停产对外贸企业的发展影响较大。3月以来逐步推进复工复产，外贸企业集中出货，医疗物资大量出口，出口总额得到改善，3、4月份的出口损失额逐渐减小，出口恢复速度较快。
    
　　进出口总额的变动会同时受到供求两端共同作用，当前国内市场复工复产逐步推进，但是国外疫情发展状况仍不容乐观，面对当前世界市场的波动，疫情对于我国进出口市场的影响还将持续一段时间，各外贸企业在稳定国内市场的同时也应为疫情之后的市场开拓做好准备。

**3.居民消费价格指数**
    
　　通过聚类分析可以直观看到，不同类别地区在疫情爆发期间食品烟酒类居民消费价格水平均有不同程度的上升，同时，第三类北京、山西在医疗保健类价格指数上也变动明显。当3月份疫情得到控制后，结合环比价格指数分析，食品烟酒类价格均有所下降，价格在控制中逐步回落，人民生活也在逐步恢复正常。基本生活消费品与人民生活息息相关，稳定物价是疫情当下首先应当实现的目标，当前政府仍需要做到在控制物价同时应稳定物资供给，保障基本民生，从分析中可以看出，预计在未来一段时间内，我国居民消费价格水平将进一步得到控制，前期价格的上升将会逐步回落。

## 5.2研究展望
    
　　在当前研究中，我们量化分析了疫情对我国居民消费和进出口的影响程度，对于把握疫情下我国经济总体状态具有一定的意义。但是，当前研究中仍有许多不足之处，在聚类分析方面，仅采用了K均值聚类方法，K均值聚类初试类中心的确定是随机的，聚类结果可能存在一定的不合理性，未来可以结合相关算法进行聚类优化。其次，本次研究仅研究了疫情对我国经济方面带来的影响，但是对于影响持续的时间没有进行相关分析，未来可以从疫情的特殊性及SARS对我国经济影响入手，结合当前我国经济发展状况，探讨COVID-19对我国经济影响可能持续时间。



# 6 致谢
　　
　行文至此，论文已接近尾声，感谢这门课程，让我们受益良多。课程结束之际，感谢闫军教授对我们论文的指导，一步步引导我们，从GitHub的使用，RMarkdown的编译，直至课程论文的顺利完成。您严谨的学术态度，循循善诱的指导给了我们很大的帮助。除此之外，感谢小伙伴的通力合作以及同学们的问题建议，希望我们可以不断进取，同时也希望阴霾散去，疫情早日结束！
　　

## 贡献声明

(1)梁青庆(组长)：负责报告中第四部分聚类分析和第五部分结论撰写。

(2)双美俊：负责报告中第二部分理论基础和第三部分描述统计撰写工作。

(3)刘利姣：负责报告中摘要、第一部分引言以及文献综述撰写。

(4)冯晓方：负责报告中第四部分实证分析中预测分析部分撰写工作。


# 参考文献

[1]郑江淮,付一夫,陶金.新冠肺炎疫情对消费经济的影响及对策分析[J].消费经济,2020,36(02):3-9.

[2]韩玉锦.新冠肺炎疫情对经济会有多大影响——基于社会消费品零售总额的角度[J].产业经济评论,2020(02):13-23.

[3]刘夏,李苑辉,欧志鹏,陈磊,陈明锐.基于ARIMA与灰色马尔科夫模型的三亚市交通客流量预测研究[J].重庆工商大学学报(自然科学版),2019,36(05):82-88.

[4]马永梅,林天水.基于我国居民消费价格指数的聚类分析[J].青海师范大学学报(自然科学版),2019,35(02):26-34.

[5]肖学培.季节性ARIMA模型对社会消费品零售总额的建模和预报[J].科技经济市场,2019(04):63-65.

[6]何海阔,王占辉.灰色模型与ARIMA乘积季节模型在河北省承德市布鲁菌病预测中的应用[J].中华地方病学杂志,2018,37(04):338-340.

[7]黄薇. 灰色马尔可夫模型在中国与东盟进出口总额预测中的研究与应用[D].兰州商学院,2010.